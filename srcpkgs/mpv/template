# Template file for 'mpv'
pkgname=mpv
version=0.27.0
revision=4
build_options="smb vapoursynth"
short_desc="Video player based on MPlayer/mplayer2"
maintainer="Juan RP <xtraeme@voidlinux.eu>"
license="GPL-2, LGPL-2.1"
homepage="https://mpv.io"
build_style=waf
configure_args="--confdir=/etc/mpv --docdir=/usr/share/examples/mpv
 --enable-dvdread --enable-dvdnav --enable-dvbin --enable-sndio
 --disable-oss-audio --disable-sdl2 --disable-pulse --disable-jack
 --disable-wayland --disable-gl-wayland --disable-libbluray --disable-libv4l2
 $(vopt_enable smb libsmbclient) $(vopt_enable vapoursynth)
 --enable-libmpv-shared"
hostmakedepends="pkg-config python-docutils perl"
makedepends="
 ffmpeg-devel libass-devel lcms2-devel libXinerama-devel lua52-devel libXv-devel
 libxkbcommon-devel libva-glx-devel libvdpau-devel alsa-lib-devel
 libdvdread-devel MesaLib-devel harfbuzz-devel libXScrnSaver-devel
 libdvdnav-devel libuuid-devel libguess-devel libXrandr-devel rubberband-devel
 sndio-devel $(vopt_if smb samba-devel) $(vopt_if vapoursynth vapoursynth-devel)"
depends="desktop-file-utils hicolor-icon-theme $(vopt_if vapoursynth vapoursynth-mvtools)"
distfiles="https://github.com/mpv-player/${pkgname}/archive/v${version}.tar.gz"
checksum=341d8bf18b75c1f78d5b681480b5b7f5c8b87d97a0d4f53a5648ede9c219a49c

if [ -z "$CROSS_BUILD" ]; then
	configure_args+=" --enable-zsh-comp"
fi

pre_configure() {
	python2 bootstrap.py
}

mpv-devel_package() {
	depends="${sourcepkg}>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/pkgconfig
		vmove usr/lib/*.so
	}
}
